---
layout: post
comments: true
title: "DP复习"
categories: "笔记"
tags:
  - 动态规划
  - 树形DP
  - 状压DP

---


HNOI2018 d2t3 那么水的树上DP都没看出来，让我意识到现在的DP水平可能还不如NOIP之前……去雅礼之前这个星期来复健一下……

## [HNOI2018] 道路
mmp当时在考场上把问题一般化为了多元函数的最值……写了个模拟退火，好像挂掉了……HN有神犇模拟退火A了…… 以及全部翻修公路70分什么鬼……

**Solution:**`f[u][x][y]` 代表在节点 $u$ ，到根的路径上未翻修公路铁路数目为 $x, y$，子树内所有叶子的最小不便利值。如果 $u$ 是城市，考虑翻修公路还是铁路，并直接从儿子转移，如果 $u$ 是乡村，直接就有 `f[u][x][y] = ci * (ai + x) * (bi + y)`.直接转移即可。
注意到答案需要`long long`，而它占用 8 Bytes ，所以直接开 DP 数组会 MLE！
DFS 的时候在栈里面开数组，然后把儿子的状态数组回传即可。这样状态数组的空间复杂度就是常数了。

## [NOIP2017] 宝藏
要是这个题目出现在了 HNOI2018 ，保证我现在做不出来……然而 NOIP 的时候只用了 1h20min 就A了……真的气

**Solution:** 首先枚举打通地面的是哪个宝藏屋，以下称为根。
再设 `f[S][u]`为当前开凿了 $S$ 集合内所有点，且生成树满足总代价最小的时候，$u$ 到根的距离；`g[S]` 为当前开凿了 $S$ 集合内点，**已开发部分**的最小总代价（注意不是剩下部分的最小总代价，否则不满足无后效性，无法转移）。
于是一定有：

$$
g(S) = \min_{S' \subseteq S} \{g(S') + L * f(S', u)\}
$$

$$
f(S, u) = \begin{cases}
f(S', u) &\text{当}g(S)\text{不在}u\text{取得最小值} \\
f(S', v) + 1  &\text{当}g(S)\text{在}u\text{取得最小值},(u, v)\text{为原图中边}
\end{cases}
$$
记忆化搜索即可。
## [SDOI2009] 学校食堂


