---
title: "线性筛&积性函数"
comments: true
tags: ["数论", "线性筛", "积性函数"]
categories: "笔记"
---

昨天晚上打Codeforces碰到一个数据结构题。

你需要支持2种操作：  

- 区间把每个数字 $$a_i$$ 变成约数个数 $$d(a_i)$$
- 区间求和。

数据范围为 $$n, q \leq 3 \times 10^5 $$。  

手玩一下发现，大概对某个区间操作6-7次整个区间就都是1和2了，于是直接分块打标记，考虑到cf服务器的速度，应该没有问题。  

然而这时候我才发现我不会线性筛求 $$d(a_i)$$ ……  

## 线性筛

用了很久的埃氏筛，因为一直搞不懂这货……  

其实懂了也不是很难。